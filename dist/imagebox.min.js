!function(i){function t(t,n){if(0>t||t>=z.length)return!1;c(),P=N=!0,I=z[t],O=I.index,W.src=I.url,i(A).html(I.title),i(S).html((z.length>1&&j.lang.counter||"").replace(/{x}/,I.index+1+"").replace(/{y}/,z.length+""));var e={top:(n?-(i(p).innerHeight()/2-n.y):0)+"px",left:(n?-(i(p).innerWidth()/2-n.x):0)+"px"},o={top:"0px",left:"0px"};i(f).css(e),i([p,h]).toggleClass("visible",!0),i(p).toggleClass("animating",!0),i(w).toggleClass("visible",!1);var a=f.animate([e,o],j.animation);return a.addEventListener("finish",function(){i(f).css(o)}),Q.push(a),!1}function n(t){i(L).html(j.lang.close),i([h,T]).attr("title",j.lang.close),i(j.root).append([h,p]),i(y).attr("title",j.lang.prev),i(C).attr("title",j.lang.next),i(f).css("padding",j.padding),i(v).toggleClass("loading",!0),i(v).css("background-image",""),i(x).css("opacity",0),i(f).css("max-width",g(t?t.width:j.initialSize,t?t.height:j.initialSize,!1).width+2*j.padding),i([y,C]).hide(),i(document).on("keydown",d)}function e(){if(!P)return!1;var n=s(),e=l();n>=0?(i(y).show(),E.src=z[n].url):i(y).hide(),e>=0?(i(C).show(),H.src=z[e].url):i(C).hide(),i(x).css({"background-image":"url('"+W.src+"')",opacity:0}),i(p).css({top:i(j.root).scrollTop(),left:i(j.root).scrollLeft()});var o=x.animate([{opacity:0},{opacity:1}],j.animation);return o.addEventListener("finish",function(){i(x).css("opacity",1),i(v).toggleClass("loading",!1),i(v).css("background-image","url('"+W.src+"')")}),Q.push(o),u(g(W.width,W.height,!0).width,function(){var n=w.animate([{"max-height":"0px"},{"max-height":"200px"}],j.animation);n.addEventListener("finish",function(){i(w).toggleClass("visible",!0),O!=I.index&&0>K?t(O):(N=!1,i(p).toggleClass("animating",!1))}),Q.push(n)}),!1}function o(){return O=s(),0>O&&(O=0),r(),!1}function a(){return O=l(),0>O&&(O=z.length-1),r(),!1}function r(){clearTimeout(K),K=setTimeout(function(){K=-1,N||O==I.index||t(O)},j.doubleClickTimeout)}function s(){return(O||(j.loop?z.length:0))-1}function l(){return(O+1)%z.length||(j.loop?0:-1)}function d(t){var n=t.which;return i.inArray(n,j.closeKeys)>=0?i.ibClose():i.inArray(n,j.nextKeys)>=0?a():i.inArray(n,j.prevKeys)>=0?o():!0}function c(){P=!1,W.src=E.src=H.src="";for(var i=0;i<Q.length;i++)Q[i].cancel();Q=[]}function g(t,n,e){var o=t,a=n;t+2*j.padding>i(p).innerWidth()&&(t=i(p).innerWidth()-2*j.padding),n=a*t/o,n+2*j.padding>i(p).innerHeight()&&(n=i(p).innerHeight()-2*j.padding),t=n*o/a;var r=100*n/t,s={"padding-bottom":r+"%"};if(e){var l={"padding-bottom":i(b).css("padding-bottom")},d=b.animate([l,s],j.animation);d.addEventListener("finish",function(){i(b).css(s)}),Q.push(d)}else i(b).css(s);return{width:t,height:n}}function u(t,n){t+=2*j.padding;var e=f.animate([{"max-width":i(f).css("max-width")},{"max-width":t+"px"}],j.animation);e.addEventListener("finish",function(){i(f).css("max-width",t),"function"==typeof n&&n()}),Q.push(e)}var h,p,f,m,b,v,x,y,C,w,k,T,S,A,L,I,K,W=new Image,E=new Image,H=new Image,z=[],B=i(window),j={},N=!1,P=!1,O=-1,Q=[],R={initialSize:200,lang:{close:"Close",prev:"Previous",next:"Next",counter:"Image {x} of {y}"},padding:30,closeKeys:[27,88,67],prevKeys:[37,80],nextKeys:[39,78],loop:!1,doubleClickTimeout:200,root:i("body")[0],animation:{duration:600,iterations:1,delay:0,easing:"ease-in-out"}};i.fn.imagebox=function(t,n,e){n=n||function(i,t){var n={url:i.getAttribute("href")||void 0,title:i.getAttribute("title")||void 0,index:t};return n},e=e||function(i,t){return!0};var o=this;return o.unbind("click").click(function(a){for(var r=this,s=0,l=[],d=i(i(this).find(i(this).attr("data-target"))[0]||this),c=0;c<o.length;c++)e.call(r,o[c],c)&&o[c]==r&&(s=c),l.push(n(o[c],c));i.extend(j,R,t),d.toggleClass("ib-line-fix",!0);var g={x:d.offset().left-i(j.root).offset().left+d.innerWidth()/2,y:d.offset().top-i(j.root).offset().top+d.innerHeight()/2,width:d.innerWidth(),height:d.innerHeight()};return d.toggleClass("ib-line-fix",!1),i.imagebox(l,s,t,g)})},i.imagebox=function(e,o,a,r){return i.extend(j,R,a),z=e,n(r),t(o,r),!1},i.ibClose=function(){return c(),i([p,w,h]).toggleClass("visible",!1),i(p).toggleClass("animating",!1),I&&(I=void 0),i(document).off("keydown",d),!1},i(R.root).append(i([h=i('<div id="ibOverlay" />').click(i.ibClose)[0],p=i('<div id="ibWrap" />')[0]])),f=i('<div id="ibCenter" />').appendTo(p)[0],m=i('<div id="ibContent" />').appendTo(f).append([b=i('<div id="ibResponsive" />').append([v=i('<div id="ibBgImage" />')[0],x=i('<div id="ibImage" />')[0],y=i('<div id="ibPrev" class="ibScrim ibScrim-left ibScrim-20"><i class="ib-icon-prev"></i></div>').on("click",o)[0],C=i('<div id="ibNext" class="ibScrim ibScrim-right ibScrim-20"><i class="ib-icon-next"></i></div>').on("click",a)[0]])[0],w=i('<div id="ibBottomContainer" />')[0]])[0],k=i('<div id="ibBottom" />').appendTo(w).append([T=i('<a id="ibCloseLink" href="#" ><span id="ibCloseText"></span><i class="ib-icon-close"></i></a>').click(i.ibClose)[0],S=i('<small id="ibCounter" />')[0],A=i('<strong id="ibCaption" />')[0]])[0],L=i(k).find("#ibCloseText")[0],i(W).on("load",e),B.on("resize",function(){I&&u(g(W.width,W.height,!1).width)}),i("a[rel^='lightbox']").imagebox({root:i(".mdl-layout.mdl-js-layout")[0]},null,function(i){return this==i||this.getAttribute("rel").length>8&&this.getAttribute("rel")==i.getAttribute("rel")})}(jQuery);